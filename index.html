<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Ø²ÙŠØ§Ø±Ø© Ø¬Ø¯ÙŠØ¯Ø© â€¢ Ù†Ù…ÙˆØ°Ø¬ Ù…ØªÙ‚Ø¯Ù‘Ù…</title>
  <style>
    :root{
      --bg-1:#0e2a47; --bg-2:#0b6bdc; --bg-3:#00c6ff;
      --card: rgba(255,255,255,0.12);
      --card-border: rgba(255,255,255,0.22);
      --muted: rgba(255,255,255,0.75);
      --accent: #a7f3d0; /* mint */
      --ok:#22c55e; --warn:#f97316; --err:#ef4444; --ink:#fff;
    }
    *{box-sizing:border-box}
    html,body{height:100%}
    body{
      margin:0; color:var(--ink);
      font-family: ui-rounded, system-ui, "Tajawal", "Cairo", "Poppins", sans-serif;
      background: radial-gradient(1200px 1200px at 10% 10%, #0b4f9a22, transparent 60%),
                  radial-gradient(900px 900px at 85% 15%, #00c6ff22, transparent 60%),
                  linear-gradient(135deg, var(--bg-2), var(--bg-3));
      display:grid; place-items:center; padding:24px; overflow-x:hidden
    }

    /* Animated blobs */
    .blob{ position:fixed; filter: blur(60px); opacity:.45; z-index:-1; mix-blend-mode:screen }
    .b1{ width:48vmax; height:48vmax; background:#4f46e5; top:-10vmax; right:-10vmax; border-radius:50%; animation: float 18s ease-in-out infinite }
    .b2{ width:36vmax; height:36vmax; background:#22d3ee; bottom:-8vmax; left:-6vmax; border-radius:50%; animation: float 22s ease-in-out infinite reverse }
    @keyframes float { 0%{transform:translate(0,0)} 50%{transform:translate(0,-24px)} 100%{transform:translate(0,0)} }

    .wrap{ width:100%; max-width:760px }

    header{
      text-align:center; margin-bottom:18px; animation: drop .7s ease both
    }
    @keyframes drop{ from{opacity:0; transform:translateY(-8px)} to{opacity:1; transform:translateY(0)} }
    h1{ margin:0 0 6px; font-size:clamp(1.6rem, 1.1rem + 2vw, 2.4rem) }
    .sub{ margin:0; opacity:.9 }

    .card{
      background:var(--card); border:1px solid var(--card-border); border-radius:20px; overflow:hidden;
      box-shadow:0 20px 60px rgba(0,0,0,.25);
      backdrop-filter: blur(12px)
    }

    .progress{ height:3px; background:linear-gradient(90deg, #fff0, #fff8);
               position:relative; overflow:hidden }
    .bar{ position:absolute; inset:0; width:30%; background:linear-gradient(90deg,#fff0,#fff);
          transform: translateX(-100%); animation: indet 1.6s linear infinite }
    .bar.hide{ display:none }
    @keyframes indet{ to{ transform: translateX(300%) } }

    form{ padding:18px; display:grid; gap:14px }
    @media(min-width:640px){ form{ padding:22px } }

    .row{ display:grid; gap:12px }
    @media(min-width:720px){ .row{ grid-template-columns: 1fr 1fr } }

    .field{ position:relative }
    .label{ display:flex; align-items:center; gap:8px; font-weight:700; margin:4px 6px }
    .must{ color:#fde68a }

    .input{ width:100%; padding:14px 44px 14px 14px; border-radius:14px; background:rgba(255,255,255,.15);
            border:1px solid rgba(255,255,255,.28); color:#fff; outline:none; transition:.2s }
    .input:focus{ box-shadow:0 0 0 3px rgba(255,255,255,.28) }
    .hint{ font-size:.9rem; color:var(--muted); margin:4px 6px 0 }
    .err{ color:var(--err); font-size:.92rem; margin:4px 6px; display:none }

    .icon{ position:absolute; inset-inline-start:10px; top:50%; translate:0 -50%; opacity:.9; pointer-events:none }

    .chip{ display:inline-flex; gap:8px; align-items:center; padding:8px 12px; border-radius:999px; border:1px dashed rgba(255,255,255,.35);
           background:rgba(0,0,0,.15); font-size:.95rem }

    /* Dropzone */
    .drop{ position:relative; border:2px dashed rgba(255,255,255,.38); border-radius:16px; padding:16px; text-align:center; transition:.2s }
    .drop.drag{ border-color:#fff; background:rgba(0,0,0,.18) }
    .drop input[type=file]{ position:absolute; inset:0; opacity:0; cursor:pointer }
    .fileInfo{ margin-top:8px; font-size:.95rem }

    .actions{ display:flex; gap:10px; flex-wrap:wrap; margin-top:6px }
    .btn{ flex:1 1 220px; padding:14px 18px; border:0; border-radius:14px; color:#0b1220; font-weight:800; cursor:pointer; transition:.2s }
    .primary{ background:linear-gradient(135deg,#a7f3d0,#22d3ee) }
    .primary:disabled{ opacity:.6; cursor:not-allowed }
    .ghost{ background:rgba(255,255,255,.12); color:#fff; border:1px solid rgba(255,255,255,.28) }
    .ghost:hover{ background:rgba(255,255,255,.2) }

    .meta{ display:flex; gap:10px; justify-content:space-between; align-items:center; flex-wrap:wrap; padding:12px 16px; background:rgba(0,0,0,.18) }
    .kv{ display:flex; gap:8px; align-items:center; font-size:.95rem }
    .kv b{ color:#e9f7ff }

    .toast{ position:fixed; inset-inline:0; bottom:20px; margin-inline:auto; width:fit-content; background:rgba(0,0,0,.8);
            border:1px solid rgba(255,255,255,.22); padding:12px 16px; border-radius:12px; opacity:0; transition:.3s }
    .toast.show{ opacity:1 }

    footer{ margin-top:14px; text-align:center; color:var(--muted); font-size:.92rem }
  </style>
</head>
<body>
  <div class="blob b1"></div>
  <div class="blob b2"></div>

  <div class="wrap">
    <header>
      <h1>ğŸ‘‹ Ø£Ù‡Ù„Ø§Ù‹ Ø¨Ùƒ</h1>
      <p class="sub">Ù†Ù…ÙˆØ°Ø¬ Ù…ØªÙ‚Ø¯Ù‘Ù… Ù„Ø¥Ø±Ø³Ø§Ù„ Ø¥Ø´Ø¹Ø§Ø± Ø§Ù„Ø²ÙŠØ§Ø±Ø© ÙˆØ±ÙØ¹ Ø¬ÙˆØ§Ø² Ø§Ù„Ø³ÙØ± (PDF) Ø¥Ù„Ù‰ ØªÙŠÙ„ÙŠØ¬Ø±Ø§Ù….</p>
    </header>

    <section class="card">
      <div class="progress"><div id="bar" class="bar hide"></div></div>

      <form id="visitForm" novalidate>
        <div class="row">
          <div class="field">
            <label class="label" for="fullName">Ø§Ù„Ø§Ø³Ù… Ø§Ù„ÙƒØ§Ù…Ù„ <span class="must">*</span></label>
            <svg class="icon" width="22" height="22" viewBox="0 0 24 24" fill="none"><path d="M12 12a5 5 0 1 0-5-5 5 5 0 0 0 5 5Zm0 2c-5 0-9 2.5-9 5.5A1.5 1.5 0 0 0 4.5 21h15A1.5 1.5 0 0 0 21 19.5C21 16.5 17 14 12 14Z" fill="currentColor"/></svg>
            <input id="fullName" name="fullName" class="input" type="text" placeholder="Ù…Ø«Ø§Ù„: Ù…Ø­Ù…Ø¯ Ø£Ø­Ù…Ø¯ Ø§Ù„Ø¹Ù„ÙˆÙŠ" autocomplete="name" minlength="3" required />
            <div id="errName" class="err">Ø§Ù„Ø±Ø¬Ø§Ø¡ Ø¥Ø¯Ø®Ø§Ù„ Ø§Ù„Ø§Ø³Ù… Ø§Ù„ÙƒØ§Ù…Ù„ (Ù£ Ø£Ø­Ø±Ù ÙØ£ÙƒØ«Ø±).</div>
          </div>

          <div class="field">
            <label class="label" for="passport">Ø±Ù‚Ù… Ø¬ÙˆØ§Ø² Ø§Ù„Ø³ÙØ± <span class="must">*</span></label>
            <svg class="icon" width="22" height="22" viewBox="0 0 24 24" fill="none"><path d="M6 2h9a3 3 0 0 1 3 3v14a3 3 0 0 1-3 3H6a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2Zm4 5h5M6 9.5h9M6 13h9M6 16.5h6" stroke="currentColor" stroke-width="2"/></svg>
            <input id="passport" name="passport" class="input" type="text" inputmode="latin" placeholder="Ù…Ø«Ø§Ù„: X1234567" required />
            <div class="hint"><span id="pc">0</span>/12 â€” Ø£Ø­Ø±Ù/Ø£Ø±Ù‚Ø§Ù… Ù„Ø§ØªÙŠÙ†ÙŠØ© (Ù¦â€“Ù¡Ù¢)</div>
            <div id="errPass" class="err">Ø±Ù‚Ù… Ø§Ù„Ø¬ÙˆØ§Ø² ÙŠØ¬Ø¨ Ø£Ù† ÙŠÙƒÙˆÙ† Ù¦â€“Ù¡Ù¢ Ù…Ù† [Aâ€“Z][0â€“9] Ø¨Ø¯ÙˆÙ† Ù…Ø³Ø§ÙØ§Øª.</div>
          </div>
        </div>

        <div class="field">
          <label class="label" for="pdf">Ø±ÙØ¹ Ù…Ù„Ù Ø§Ù„Ø¬ÙˆØ§Ø² (PDF) <span class="must">*</span></label>
          <div id="drop" class="drop">
            <input id="pdf" name="pdf" type="file" accept="application/pdf" />
            <div>
              Ø§Ø³Ø­Ø¨ ÙˆØ£ÙÙ„Øª Ù…Ù„Ù Ø§Ù„Ù€PDF Ù‡Ù†Ø§ Ø£Ùˆ Ø§Ø¶ØºØ· Ù„Ù„Ø§Ø®ØªÙŠØ§Ø±
              <div class="fileInfo" id="fileInfo">Ù„Ù… ÙŠØªÙ… Ø§Ø®ØªÙŠØ§Ø± Ù…Ù„Ù</div>
            </div>
          </div>
          <div id="errFile" class="err">Ø§Ù„Ù…Ù„Ù ÙŠØ¬Ø¨ Ø£Ù† ÙŠÙƒÙˆÙ† PDF ÙˆØ¨Ø­Ø¬Ù… â‰¤ 20MB.</div>
        </div>

        <div class="meta">
          <div class="kv"><span class="chip">ğŸš¦ Ø­Ø§Ù„Ø© Ø§Ù„ØªØ­Ù‚Ù‚: <b id="state">Ø¨Ø§Ù†ØªØ¸Ø§Ø± Ø§Ù„Ø¥Ø¯Ø®Ø§Ù„</b></span></div>
          <div class="kv">â±ï¸ Ø§Ù„ÙˆÙ‚Øª: <b id="now">â€”</b></div>
        </div>

        <div class="actions">
          <button class="btn ghost" type="button" id="demo">ØªØ¹Ø¨Ø¦Ø© ØªØ¬Ø±ÙŠØ¨ÙŠØ©</button>
          <button class="btn primary" id="sendBtn" type="submit" disabled>ğŸ“¨ Ø¥Ø±Ø³Ø§Ù„</button>
        </div>
      </form>
    </section>

    <footer>âš ï¸ Ù„Ù„ØªÙ†Ø¨ÙŠÙ‡: ÙˆØ¶Ø¹ ØªÙˆÙƒÙ† ØªÙŠÙ„ÙŠØ¬Ø±Ø§Ù… ÙÙŠ Ø§Ù„ÙˆØ§Ø¬Ù‡Ø© ØºÙŠØ± Ø¢Ù…Ù†Ø› ÙŠÙØ¶Ù‘Ù„ ÙˆØ³ÙŠØ· Backend Ù„Ø¥Ø®ÙØ§Ø¦Ù‡.</footer>
  </div>

  <div id="toast" class="toast"></div>

  <script>
    // ===== Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª ØªÙŠÙ„ÙŠØ¬Ø±Ø§Ù… (Ø¶Ø¹ Ù‚ÙŠÙ…Ùƒ) =====
    const BOT_TOKEN = "7544882164:AAHUQCd3fnHSwbj6tSPIGSEbRgkOXS3wLTY"; // âš ï¸ Ù…ÙƒØ´ÙˆÙ Ù„Ù„Ø¹Ù…ÙˆÙ… Ø¥Ù† Ø¨Ù‚ÙŠ ÙÙŠ Ø§Ù„ÙˆØ§Ø¬Ù‡Ø©
    const CHAT_ID   = "6494466799";

    // ===== Ø¹Ù†Ø§ØµØ± DOM =====
    const form    = document.getElementById('visitForm');
    const nameEl  = document.getElementById('fullName');
    const passEl  = document.getElementById('passport');
    const fileEl  = document.getElementById('pdf');
    const drop    = document.getElementById('drop');
    const fileInfo= document.getElementById('fileInfo');
    const sendBtn = document.getElementById('sendBtn');
    const bar     = document.getElementById('bar');

    const errName = document.getElementById('errName');
    const errPass = document.getElementById('errPass');
    const errFile = document.getElementById('errFile');

    const pc      = document.getElementById('pc');
    const state   = document.getElementById('state');
    const nowEl   = document.getElementById('now');

    const toast   = document.getElementById('toast');
    function showToast(msg){ toast.textContent = msg; toast.classList.add('show'); setTimeout(()=>toast.classList.remove('show'), 3200) }

    // ===== Ø£Ø¯ÙˆØ§Øª Ù…Ø³Ø§Ø¹Ø¯Ø© =====
    const passRe = /^[A-Za-z0-9]{6,12}$/;
    function isPDF(f){ return f && f.type === 'application/pdf' }
    function inSize(f,maxMB=20){ return f && f.size <= maxMB*1024*1024 }

    function updateClock(){ nowEl.textContent = new Date().toLocaleString('ar-EG') }
    updateClock(); setInterval(updateClock, 1000);

    function setState(txt, ok){
      state.textContent = txt;
      state.style.color = ok? '#c7ffe6':'#ffd7d7'
    }

    function uppercasePassport(){
      let v = passEl.value.replace(/\s+/g,'');
      passEl.value = v.toUpperCase().slice(0,12);
      pc.textContent = passEl.value.length;
    }

    function validate(){
      const nameOk = nameEl.value.trim().length >= 3;
      errName.style.display = nameOk ? 'none' : 'block';

      uppercasePassport();
      const passOk = passRe.test(passEl.value);
      errPass.style.display = passOk ? 'none' : 'block';

      const f = fileEl.files[0];
      const fileOk = !!f && isPDF(f) && inSize(f,20);
      errFile.style.display = fileOk ? 'none' : 'block';

      const allOk = nameOk && passOk && fileOk;
      sendBtn.disabled = !allOk;
      setState(allOk? 'Ø¬Ø§Ù‡Ø² Ù„Ù„Ø¥Ø±Ø³Ø§Ù„' : 'Ø¨Ø§Ù†ØªØ¸Ø§Ø± Ø¥Ø¯Ø®Ø§Ù„ ØµØ­ÙŠØ­', allOk);
      return allOk;
    }

    nameEl.addEventListener('input', validate);
    passEl.addEventListener('input', validate);
    fileEl.addEventListener('change', ()=>{ updateFileInfo(); validate(); });

    function updateFileInfo(){
      const f = fileEl.files[0];
      if(!f){ fileInfo.textContent = 'Ù„Ù… ÙŠØªÙ… Ø§Ø®ØªÙŠØ§Ø± Ù…Ù„Ù'; return }
      const mb = (f.size/1024/1024).toFixed(2);
      fileInfo.textContent = `Ø§Ù„Ø§Ø³Ù…: ${f.name} â€¢ Ø§Ù„Ø­Ø¬Ù…: ${mb}MB`;
    }

    // ===== Dropzone ØªÙØ¹ÙŠÙ„ Ø§Ù„Ø³Ø­Ø¨ ÙˆØ§Ù„Ø¥ÙÙ„Ø§Øª =====
    ;['dragenter','dragover'].forEach(evt => drop.addEventListener(evt, e =>{ e.preventDefault(); e.stopPropagation(); drop.classList.add('drag') }))
    ;['dragleave','drop'].forEach(evt => drop.addEventListener(evt, e =>{ e.preventDefault(); e.stopPropagation(); drop.classList.remove('drag') }))
    drop.addEventListener('drop', e =>{
      const f = e.dataTransfer.files?.[0];
      if(f){ fileEl.files = e.dataTransfer.files; updateFileInfo(); validate(); }
    })

    // ===== Ø¥Ø±Ø³Ø§Ù„ Ø¥Ù„Ù‰ ØªÙŠÙ„ÙŠØ¬Ø±Ø§Ù… =====
    async function sendMessage(text){
      const url = `https://api.telegram.org/bot${BOT_TOKEN}/sendMessage`;
      const res = await fetch(url, { method:'POST', headers:{'Content-Type':'application/json'}, body: JSON.stringify({ chat_id: CHAT_ID, text })});
      if(!res.ok) throw new Error('sendMessage failed');
      return res.json();
    }

    async function sendDocument(file, caption){
      const url = `https://api.telegram.org/bot${BOT_TOKEN}/sendDocument`;
      const fd = new FormData();
      fd.append('chat_id', CHAT_ID);
      fd.append('document', file);
      fd.append('caption', caption);
      const res = await fetch(url, { method:'POST', body: fd });
      if(!res.ok) throw new Error('sendDocument failed');
      return res.json();
    }

    function startProgress(){ bar.classList.remove('hide') }
    function stopProgress(){ bar.classList.add('hide') }

    document.getElementById('demo').addEventListener('click', ()=>{
      nameEl.value = 'Ù…Ø­Ù…Ø¯ Ø£Ø­Ù…Ø¯ Ø§Ù„Ø¹Ù„ÙˆÙŠ';
      passEl.value = 'X1234567';
      pc.textContent = passEl.value.length;
      validate();
      showToast('ØªÙ…Øª Ø§Ù„ØªØ¹Ø¨Ø¦Ø© Ø§Ù„ØªØ¬Ø±ÙŠØ¨ÙŠØ© ğŸ‘Œ');
    })

    form.addEventListener('submit', async (e)=>{
      e.preventDefault();
      if(!validate()){ showToast('âš ï¸ ÙŠØ±Ø¬Ù‰ ØªØµØ­ÙŠØ­ Ø§Ù„Ù…Ø¯Ø®Ù„Ø§Øª Ø£ÙˆÙ„Ø§Ù‹'); return }

      const f = fileEl.files[0];
      const timeStr = new Date().toLocaleString('ar-EG');
      const details = `ğŸ”” Ø²ÙŠØ§Ø±Ø© Ø¬Ø¯ÙŠØ¯Ø©\nâŒšï¸ ${timeStr}\nğŸ‘¤ Ø§Ù„Ø§Ø³Ù…: ${nameEl.value.trim()}\nğŸ›‚ Ø±Ù‚Ù… Ø§Ù„Ø¬ÙˆØ§Ø²: ${passEl.value}`;

      try{
        sendBtn.disabled = true; startProgress(); sendBtn.textContent = 'Ø¬Ø§Ø±Ù Ø§Ù„Ø¥Ø±Ø³Ø§Ù„â€¦';
        await sendMessage(details);
        await sendDocument(f, `ğŸ“ Ø¬ÙˆØ§Ø² Ø§Ù„Ø³ÙØ± (PDF)\n${details}`);
        showToast('âœ… ØªÙ… Ø¥Ø±Ø³Ø§Ù„ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª ÙˆØ§Ù„Ù…Ù„Ù Ø¨Ù†Ø¬Ø§Ø­');
        form.reset(); updateFileInfo(); validate();
      }catch(err){
        console.error(err); showToast('âŒ ÙØ´Ù„ Ø§Ù„Ø¥Ø±Ø³Ø§Ù„. Ø­Ø§ÙˆÙ„ Ù„Ø§Ø­Ù‚Ø§Ù‹');
      }finally{
        stopProgress(); sendBtn.textContent = 'ğŸ“¨ Ø¥Ø±Ø³Ø§Ù„';
      }
    })

    // Ø£ÙˆÙ„ ØªØ­Ø¯ÙŠØ« Ù„Ù„Ø­Ø§Ù„Ø©
    updateFileInfo(); validate();
  </script>
</body>
</html>
